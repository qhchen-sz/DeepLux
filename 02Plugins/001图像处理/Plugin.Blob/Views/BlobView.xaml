<vb:ModuleViewBase
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:vb="clr-namespace:HV.Core;assembly=HV"      
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Plugin.Blob.Views"
             xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
             xmlns:vm="clr-namespace:Plugin.Blob.ViewModels"
             xmlns:m="clr-namespace:Plugin.Blob.Models"
             xmlns:WinFormHost="clr-namespace:System.Windows.Forms.Integration;assembly=WindowsFormsIntegration"
             xmlns:Converter="clr-namespace:HV.Assets.Converter;assembly=HV" x:Class="Plugin.Blob.Views.PerProcessingView"
             Height="680" Width="980" Icon="/Plugin.Blob;component/Assets/Images/Tool/Blob.png" Loaded="ModuleViewBase_Loaded" >
    <vb:ModuleViewBase.Resources>
        <Converter:Bool2VisibilityConverter x:Key="Bool2VisibilityConverter"/>
    </vb:ModuleViewBase.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition/>
            <RowDefinition Height="55"/>
        </Grid.RowDefinitions>
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="370"/>
                <ColumnDefinition Width="4"/>
                <ColumnDefinition/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition/>
                <RowDefinition/>
            </Grid.RowDefinitions>
            <TabControl Grid.RowSpan="2">
                <TabControl.Resources>
                    <Style TargetType="{x:Type TabItem}" BasedOn="{StaticResource VerTabItem}"/>
                </TabControl.Resources>
                <TabControl.Style>
                    <StaticResource ResourceKey="VerTabControl"/>
                </TabControl.Style>
                <TabItem Header="基本参数">
                    <Grid x:Name="gd">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="100"/>
                            <RowDefinition Height="60"/>
                            <RowDefinition Height="80"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <Border >
                            <GroupBox Header="图像链接">
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="5 0">
                                    <TextBlock Text="输入图像" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    <TextBox HorizontalAlignment="Center" VerticalAlignment="Center" BorderThickness="0 0 0 1" Width="200" Margin="5 0" IsReadOnly="True"
                                                 Style="{StaticResource LinkTextBox}"
                                                 Text="{Binding InputImageLinkText}"
                                                 mah:TextBoxHelper.LinkButtonCommand="{Binding LinkCommand, Mode=OneWay}"
                                                 mah:TextBoxHelper.LinkButtonCommandParameter="{x:Static vm:eLinkCommand.InputImageLink}"/>
                                </StackPanel>
                            </GroupBox>
                        </Border>

                        <Border Grid.Row="1">
                            <GroupBox Header="ROI类型">
                                <StackPanel Orientation="Horizontal" Margin="5 0" VerticalAlignment="Center" HorizontalAlignment="Center">
                                    <RadioButton Content="全图" Margin="5 0" 
                                                 IsChecked="{Binding SelectedROIType, ConverterParameter={x:Static vm:eRoiType.全图}, Converter={StaticResource EnumConverter}}"/>
                                    <RadioButton Content="ROI链接" Margin="35 0" 
                                                 IsChecked="{Binding SelectedROIType, ConverterParameter={x:Static vm:eRoiType.ROI链接}, Converter={StaticResource EnumConverter}}"/>
                                </StackPanel>
                            </GroupBox>
                        </Border>

                        <Border x:Name="bd" Grid.Row="2">
                            <GroupBox Header="ROI信息" >
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="AUTO"/>
                                        <RowDefinition/>
                                    </Grid.RowDefinitions>
                                    <Grid Visibility="{Binding SelectedROIType, ConverterParameter={x:Static vm:eRoiType.ROI链接}, Converter={StaticResource EnumToVisibilityConverter}}">
                                        <StackPanel>
                                            <StackPanel Orientation="Horizontal" Margin="30 10">
                                                <TextBlock Text="ROI:" VerticalAlignment="Center" HorizontalAlignment="Center" Width="60"/>
                                                <TextBox Style="{StaticResource LinkTextBox}" Width="200"
                                                 Text="{Binding InputRoiLinkText}" 
                                                 IsReadOnly="True"
                                                 mah:TextBoxHelper.LinkButtonCommand="{Binding LinkCommand, Mode=OneWay}"
                                                 mah:TextBoxHelper.LinkButtonCommandParameter="{x:Static vm:eLinkCommand.Roi}"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </Grid>
                                </Grid>
                            </GroupBox>
                        </Border>

                        <Border Grid.Row="3">
                            <GroupBox Header="二值化" >
                                <StackPanel Orientation="Horizontal" Margin="5">
                                    <TextBlock Text="分割阈值:" VerticalAlignment="Center"  Margin="5,1,5,1"/>
                                    <mah:RangeSlider Width="200"    
                                     Margin="4"
                                     mah:SliderHelper.ChangeValueBy="LargeChange"
                                     mah:SliderHelper.EnableMouseWheel="MouseHover"
                                     AutoToolTipPlacement="TopLeft"
                                     LargeChange="1"
                                     LowerValue="{Binding ThresholdMin}"
                                     Maximum="255"
                                     Minimum="0"
                                     Orientation="Horizontal"
                                     SmallChange="1"
                                     UpperValue="{Binding ThresholdMax}">
                                        <mah:RangeSlider.AutoToolTipRangeValuesTemplate>
                                            <DataTemplate DataType="mah:RangeSliderAutoTooltipValues">
                                                <UniformGrid Columns="2" Rows="2">
                                                    <TextBlock HorizontalAlignment="Right" Text="From:" />
                                                    <TextBlock HorizontalAlignment="Right" Text="{Binding LowerValue, StringFormat='{}{0:N2}'}" />
                                                    <TextBlock HorizontalAlignment="Right" Text="To:" />
                                                    <TextBlock HorizontalAlignment="Right" Text="{Binding UpperValue, StringFormat='{}{0:N2}'}" />
                                                </UniformGrid>
                                            </DataTemplate>
                                        </mah:RangeSlider.AutoToolTipRangeValuesTemplate>
                                    </mah:RangeSlider>
                                </StackPanel>
                            </GroupBox>
                            
                        </Border>
                    </Grid>
                </TabItem>
                <TabItem Header="参数设置" Height="30" VerticalAlignment="Bottom">
                    <Grid x:Name="gd1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="50"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <StackPanel Orientation="Horizontal" Grid.Row="0" Cursor="">
                            <Menu VerticalAlignment="Center" Margin="10,0,0,0" ToolTip="添加">
                                <MenuItem Header="➕" HorizontalAlignment="Center" VerticalContentAlignment="Center" >
                                    <MenuItem Header="区域操作" HorizontalAlignment="Center" VerticalContentAlignment="Center" >
                                        <MenuItem Header="连通" Command="{Binding DataOperateCommand}" CommandParameter="add_连通"/>
                                        <MenuItem Header="合并" Command="{Binding DataOperateCommand}" CommandParameter="add_合并"/>
                                        <MenuItem Header="补集" Command="{Binding DataOperateCommand}" CommandParameter="add_补集"/>
                                        <MenuItem Header="相减" Command="{Binding DataOperateCommand}" CommandParameter="add_相减"/>
                                        <MenuItem Header="相交" Command="{Binding DataOperateCommand}" CommandParameter="add_相交"/>
                                        <MenuItem Header="孔洞填充" Command="{Binding DataOperateCommand}" CommandParameter="add_孔洞填充"/>

                                    </MenuItem>
                                    <MenuItem Header="形态学" HorizontalAlignment="Center" VerticalContentAlignment="Center" >
                                        <MenuItem Header="开运算" Command="{Binding DataOperateCommand}" CommandParameter="add_开运算"/>
                                        <MenuItem Header="闭运算" Command="{Binding DataOperateCommand}" CommandParameter="add_闭运算"/>
                                        <MenuItem Header="腐蚀" Command="{Binding DataOperateCommand}" CommandParameter="add_腐蚀"/>
                                        <MenuItem Header="膨胀" Command="{Binding DataOperateCommand}" CommandParameter="add_膨胀"/>
                                    </MenuItem>
                                    <MenuItem Header="高级操作" HorizontalAlignment="Center" VerticalContentAlignment="Center" >
                                        <MenuItem Header="特征筛选" Command="{Binding DataOperateCommand}" CommandParameter="add_特征筛选"/>
                                        <MenuItem Header="转换" Command="{Binding DataOperateCommand}" CommandParameter="add_转换"/>
                                        <MenuItem Header="矩形分割" Command="{Binding DataOperateCommand}" CommandParameter="add_矩形分割"/>
                                        <MenuItem Header="获取最大区域" Command="{Binding DataOperateCommand}" CommandParameter="add_获取最大区域"/>
                                    </MenuItem>

                                </MenuItem>
                            </Menu>

                            <Button Style="{StaticResource ToolBarButtonStyle}" ToolTip="删除" Margin="10,0,0,0"
                                    Command="{Binding DataOperateCommand}" CommandParameter="remove">
                                <Image Source="/Plugin.Blob;component/Assets/Images/Tool/delete.png"/>
                            </Button>
                            <Button Style="{StaticResource ToolBarButtonStyle}" ToolTip="上移" Margin="10,0,0,0"
                                    Command="{Binding DataOperateCommand}" CommandParameter="up">
                                <Image Source="/Plugin.Blob;component/Assets/Images/Tool/up.png"/>
                            </Button>
                            <Button Style="{StaticResource ToolBarButtonStyle}" ToolTip="下移" Margin="10,0,0,0"
                                    Command="{Binding DataOperateCommand}" CommandParameter="down">
                                <Image Source="/Plugin.Blob;component/Assets/Images/Tool/down.png"/>
                            </Button>
                            <CheckBox Content="实时刷新" Margin="30,0,0,0" />
                        </StackPanel>
                        <DataGrid Grid.Row="1" AutoGenerateColumns="False" x:Name="dg"
                                                  EnableColumnVirtualization="true"
                                                  EnableRowVirtualization="true"
                                                  VirtualizingPanel.IsVirtualizing="True"
                                                  ItemsSource="{Binding m_ToolList}" SelectedItem="{Binding SelectedText}" SelectedIndex="{Binding SelectedIndex}"
                                                  FontSize="14" 
                                                  RowHeaderWidth="20"
                                                  SelectionUnit="FullRow"                               
                                                  HeadersVisibility="Column"
                                                  GridLinesVisibility="Horizontal"                                  
                                                  IsReadOnly="True" CanUserAddRows="False">
                            <DataGrid.Columns>
                                <DataGridTemplateColumn Header="启用" IsReadOnly="True" Width="*">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <CheckBox IsChecked="{Binding m_enable ,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                      HorizontalAlignment="Center" IsEnabled="True" MinWidth="0"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="索引" IsReadOnly="True" Width="*">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate> 
                                            <TextBlock Text="{Binding m_id}"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="类型" IsReadOnly="True" Width="2*">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding m_name}"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="参数" IsReadOnly="True" Width="3*">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding m_value}"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                        <GroupBox Header="参数" Grid.Row="2" >
                            <Grid Visibility="{Binding IsDisp,Converter={StaticResource Bool2VisibilityConverter}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="17*"/>
                                    <ColumnDefinition Width="160*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <!--连通-->
                                <StackPanel Orientation="Vertical"  Visibility="{Binding SelectedText.m_name,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eOperatorType.连通}}" Grid.ColumnSpan="2"/>
                                <!--合并-->
                                <StackPanel Orientation="Vertical" Visibility="{Binding SelectedText.m_name,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eOperatorType.合并}}" Grid.ColumnSpan="2">
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10">
                                        <TextBlock Text="使用索引:" VerticalAlignment="Center" Width="60"/>
                                        <ComboBox MinWidth="200" BorderThickness="0 0 0 1"    
                                          ItemsSource="{Binding SelectedText.Union1Index}"
                                          SelectedItem="{Binding SelectedText.m_Union1Index, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                </StackPanel>
                                <!--补集-->
                                <StackPanel Orientation="Vertical" Visibility="{Binding SelectedText.m_name,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eOperatorType.补集}}" Grid.ColumnSpan="2">
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10">
                                        <TextBlock Text="使用索引:" VerticalAlignment="Center" Width="60"/>
                                        <ComboBox MinWidth="200" BorderThickness="0 0 0 1"    
                                          ItemsSource="{Binding SelectedText.ComplementIndex}"
                                          SelectedItem="{Binding SelectedText.m_ComplementIndex, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                </StackPanel>
                                <!--相减-->
                                <StackPanel Orientation="Vertical"  Visibility="{Binding SelectedText.m_name,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eOperatorType.相减}}" Grid.ColumnSpan="2">
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10">
                                        <TextBlock Text="使用索引:" VerticalAlignment="Center" Width="60"/>
                                        <ComboBox MinWidth="200" BorderThickness="0 0 0 1"    
                                          ItemsSource="{Binding SelectedText.DifferenceIndex}"
                                          SelectedItem="{Binding SelectedText.m_DifferenceIndex, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10">
                                        <TextBlock Text="目标索引:" VerticalAlignment="Center" Width="60"/>
                                        <ComboBox MinWidth="200" BorderThickness="0 0 0 1"    
                                          ItemsSource="{Binding SelectedText.DifferenceIndex2}"
                                          SelectedItem="{Binding SelectedText.m_DifferenceIndex2, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                </StackPanel>
                                <!--相交-->
                                <StackPanel Orientation="Vertical"  Visibility="{Binding SelectedText.m_name,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eOperatorType.相交}}" Grid.ColumnSpan="2">
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10">
                                        <TextBlock Text="使用索引:" VerticalAlignment="Center" Width="60"/>
                                        <ComboBox MinWidth="200" BorderThickness="0 0 0 1"    
                                          ItemsSource="{Binding SelectedText.IntersectionIndex}"
                                          SelectedItem="{Binding SelectedText.m_IntersectionIndex, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10">
                                        <TextBlock Text="目标索引:" VerticalAlignment="Center" Width="60"/>
                                        <ComboBox MinWidth="200" BorderThickness="0 0 0 1"    
                                          ItemsSource="{Binding SelectedText.IntersectionIndex2}"
                                          SelectedItem="{Binding SelectedText.m_IntersectionIndex2, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                </StackPanel>
                                <!--孔洞填充-->
                                <StackPanel Orientation="Vertical"  Visibility="{Binding SelectedText.m_name,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eOperatorType.孔洞填充}}" Grid.ColumnSpan="2">
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10">
                                        <TextBlock Text="使用索引:" VerticalAlignment="Center" Width="60"/>
                                        <ComboBox MinWidth="200" BorderThickness="0 0 0 1"    
                                          ItemsSource="{Binding SelectedText.FillIndex}"
                                          SelectedItem="{Binding SelectedText.m_FillIndex, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                </StackPanel>
                                <!--开运算-->
                                <StackPanel Orientation="Vertical"  Visibility="{Binding SelectedText.m_name,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eOperatorType.开运算}}" Grid.ColumnSpan="2">
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10">
                                        <TextBlock Text="使用索引:" VerticalAlignment="Center" Width="60"/>
                                        <ComboBox MinWidth="200" BorderThickness="0 0 0 1"    
                                          ItemsSource="{Binding SelectedText.OpenIndex}"
                                          SelectedItem="{Binding SelectedText.m_OpenIndex, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10">
                                        <TextBlock Text="结构元素:" VerticalAlignment="Center" Width="60"/>
                                        <ComboBox MinWidth="200" BorderThickness="0 0 0 1"    
                                          ItemsSource="{Binding SelectedText.StructuralElements}"
                                          SelectedItem="{Binding SelectedText.m_StructuralElements, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10" Visibility="{Binding SelectedText.m_StructuralElements,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eStructuralElements.矩形}}">
                                        <TextBlock Text="宽度:" VerticalAlignment="Center" Width="60"/>
                                        <mah:NumericUpDown Minimum="1" Value="{Binding SelectedText.m_OpenWidth}" Width="200" Margin="5 0" BorderThickness="0 0 0 1"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10" Visibility="{Binding SelectedText.m_StructuralElements,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eStructuralElements.矩形}}">
                                        <TextBlock Text="高度:" VerticalAlignment="Center" Width="60"/>
                                        <mah:NumericUpDown Minimum="1" Value="{Binding SelectedText.m_OpenHeight}" Width="200" Margin="5 0" BorderThickness="0 0 0 1"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10" Visibility="{Binding SelectedText.m_StructuralElements,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eStructuralElements.圆形}}">
                                        <TextBlock Text="直径:" VerticalAlignment="Center" Width="60"/>
                                        <mah:NumericUpDown Minimum="1" Value="{Binding SelectedText.m_OpenRadius}" Width="200" Margin="5 0" BorderThickness="0 0 0 1"/>
                                    </StackPanel>

                                </StackPanel>
                                <!--闭运算-->
                                <StackPanel Orientation="Vertical"  Visibility="{Binding SelectedText.m_name,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eOperatorType.闭运算}}" Grid.ColumnSpan="2">
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10">
                                        <TextBlock Text="使用索引:" VerticalAlignment="Center" Width="60"/>
                                        <ComboBox MinWidth="200" BorderThickness="0 0 0 1"    
                                          ItemsSource="{Binding SelectedText.CloseIndex}"
                                          SelectedItem="{Binding SelectedText.m_CloseIndex, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10">
                                        <TextBlock Text="结构元素:" VerticalAlignment="Center" Width="60"/>
                                        <ComboBox MinWidth="200" BorderThickness="0 0 0 1"    
                                          ItemsSource="{Binding SelectedText.StructuralElements}"
                                          SelectedItem="{Binding SelectedText.m_StructuralElements, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10" Visibility="{Binding SelectedText.m_StructuralElements,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eStructuralElements.矩形}}">
                                        <TextBlock Text="宽度:" VerticalAlignment="Center" Width="60"/>
                                        <mah:NumericUpDown Minimum="1" Value="{Binding SelectedText.m_CloseWidth}" Width="200" Margin="5 0" BorderThickness="0 0 0 1"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10" Visibility="{Binding SelectedText.m_StructuralElements,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eStructuralElements.矩形}}">
                                        <TextBlock Text="高度:" VerticalAlignment="Center" Width="60"/>
                                        <mah:NumericUpDown Minimum="1" Value="{Binding SelectedText.m_CloseHeight}" Width="200" Margin="5 0" BorderThickness="0 0 0 1"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10" Visibility="{Binding SelectedText.m_StructuralElements,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eStructuralElements.圆形}}">
                                        <TextBlock Text="直径:" VerticalAlignment="Center" Width="60"/>
                                        <mah:NumericUpDown Minimum="1" Value="{Binding SelectedText.m_CloseRadius}" Width="200" Margin="5 0" BorderThickness="0 0 0 1"/>
                                    </StackPanel>

                                </StackPanel>
                                <!--腐蚀-->
                                <StackPanel Orientation="Vertical"  Visibility="{Binding SelectedText.m_name,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eOperatorType.腐蚀}}" Grid.ColumnSpan="2">
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10">
                                        <TextBlock Text="使用索引:" VerticalAlignment="Center" Width="60"/>
                                        <ComboBox MinWidth="200" BorderThickness="0 0 0 1"    
                                          ItemsSource="{Binding SelectedText.ErosionIndex}"
                                          SelectedItem="{Binding SelectedText.m_ErosionIndex, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10">
                                        <TextBlock Text="结构元素:" VerticalAlignment="Center" Width="60"/>
                                        <ComboBox MinWidth="200" BorderThickness="0 0 0 1"    
                                          ItemsSource="{Binding SelectedText.StructuralElements}"
                                          SelectedItem="{Binding SelectedText.m_StructuralElements, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10" Visibility="{Binding SelectedText.m_StructuralElements,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eStructuralElements.矩形}}">
                                        <TextBlock Text="宽度:" VerticalAlignment="Center" Width="60"/>
                                        <mah:NumericUpDown Minimum="1" Value="{Binding SelectedText.m_ErosionWidth}" Width="200" Margin="5 0" BorderThickness="0 0 0 1"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10" Visibility="{Binding SelectedText.m_StructuralElements,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eStructuralElements.矩形}}">
                                        <TextBlock Text="高度:" VerticalAlignment="Center" Width="60"/>
                                        <mah:NumericUpDown Minimum="1" Value="{Binding SelectedText.m_ErosionHeight}" Width="200" Margin="5 0" BorderThickness="0 0 0 1"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10" Visibility="{Binding SelectedText.m_StructuralElements,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eStructuralElements.圆形}}">
                                        <TextBlock Text="直径:" VerticalAlignment="Center" Width="60"/>
                                        <mah:NumericUpDown Minimum="1" Value="{Binding SelectedText.m_ErosionRadius}" Width="200" Margin="5 0" BorderThickness="0 0 0 1"/>
                                    </StackPanel>

                                </StackPanel>
                                <!--膨胀-->
                                <StackPanel Orientation="Vertical"  Visibility="{Binding SelectedText.m_name,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eOperatorType.膨胀}}" Grid.ColumnSpan="2">
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10">
                                        <TextBlock Text="使用索引:" VerticalAlignment="Center" Width="60"/>
                                        <ComboBox MinWidth="200" BorderThickness="0 0 0 1"    
                                          ItemsSource="{Binding SelectedText.DilationIndex}"
                                          SelectedItem="{Binding SelectedText.m_DilationIndex, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10">
                                        <TextBlock Text="结构元素:" VerticalAlignment="Center" Width="60"/>
                                        <ComboBox MinWidth="200" BorderThickness="0 0 0 1"    
                                          ItemsSource="{Binding SelectedText.StructuralElements}"
                                          SelectedItem="{Binding SelectedText.m_StructuralElements, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10" Visibility="{Binding SelectedText.m_StructuralElements,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eStructuralElements.矩形}}">
                                        <TextBlock Text="宽度:" VerticalAlignment="Center" Width="60"/>
                                        <mah:NumericUpDown Minimum="1" Value="{Binding SelectedText.m_DilationWidth}" Width="200" Margin="5 0" BorderThickness="0 0 0 1"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10" Visibility="{Binding SelectedText.m_StructuralElements,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eStructuralElements.矩形}}">
                                        <TextBlock Text="高度:" VerticalAlignment="Center" Width="60"/>
                                        <mah:NumericUpDown Minimum="1" Value="{Binding SelectedText.m_DilationHeight}" Width="200" Margin="5 0" BorderThickness="0 0 0 1"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10" Visibility="{Binding SelectedText.m_StructuralElements,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eStructuralElements.圆形}}">
                                        <TextBlock Text="直径:" VerticalAlignment="Center" Width="60"/>
                                        <mah:NumericUpDown Minimum="1" Value="{Binding SelectedText.m_DilationRadius}" Width="200" Margin="5 0" BorderThickness="0 0 0 1"/>
                                    </StackPanel>

                                </StackPanel>
                                <!--特征筛选-->
                                <StackPanel Orientation="Vertical"  Visibility="{Binding SelectedText.m_name,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eOperatorType.特征筛选}}" Grid.ColumnSpan="2">
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10">
                                        <TextBlock Text="使用索引:" VerticalAlignment="Center" Width="60"/>
                                        <ComboBox MinWidth="200" BorderThickness="0 0 0 1"    
                                          ItemsSource="{Binding SelectedText.FeaturesIndex}"
                                          SelectedItem="{Binding SelectedText.m_FeaturesIndex, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10">
                                        <TextBlock Text="筛选条件:" VerticalAlignment="Center" Width="60"/>
                                        <ComboBox MinWidth="200" BorderThickness="0 0 0 1"    
                                          ItemsSource="{Binding SelectedText.FilterConditions}"
                                          SelectedItem="{Binding SelectedText.m_FilterConditions, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10">
                                        <TextBlock Text="条件关系:" VerticalAlignment="Center" Width="60"/>
                                        <ComboBox MinWidth="200" BorderThickness="0 0 0 1"    
                                          ItemsSource="{Binding SelectedText.ConditionalRelationship}"
                                          SelectedItem="{Binding SelectedText.m_ConditionalRelationship, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10" >
                                        <TextBlock Text="最小值:" VerticalAlignment="Center" Width="60"/>
                                        <mah:NumericUpDown Minimum="0" Value="{Binding SelectedText.m_FeaturesMin}" Width="200" Margin="5 0" BorderThickness="0 0 0 1"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10" >
                                        <TextBlock Text="最大值:" VerticalAlignment="Center" Width="60"/>
                                        <mah:NumericUpDown Minimum="0" Value="{Binding SelectedText.m_FeaturesMax}" Width="200" Margin="5 0" BorderThickness="0 0 0 1"/>
                                    </StackPanel>


                                </StackPanel>
                                <!--转换-->
                                <StackPanel Orientation="Vertical"  Visibility="{Binding SelectedText.m_name,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eOperatorType.转换}}" Grid.ColumnSpan="2">
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10">
                                        <TextBlock Text="使用索引:" VerticalAlignment="Center" Width="60"/>
                                        <ComboBox MinWidth="200" BorderThickness="0 0 0 1"    
                                          ItemsSource="{Binding SelectedText.ConversionIndex}"
                                          SelectedItem="{Binding SelectedText.m_ConversionIndex, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10">
                                        <TextBlock Text="参数:" VerticalAlignment="Center" Width="60"/>
                                        <ComboBox MinWidth="200" BorderThickness="0 0 0 1"    
                                          ItemsSource="{Binding SelectedText.ConversionType}"
                                          SelectedItem="{Binding SelectedText.m_ConversionType, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>


                                </StackPanel>
                                <!--获取最大区域-->
                                <StackPanel Orientation="Vertical"  Visibility="{Binding SelectedText.m_name,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eOperatorType.获取最大区域}}" Grid.ColumnSpan="2">
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10">
                                        <TextBlock Text="使用索引:" VerticalAlignment="Center" Width="60"/>
                                        <ComboBox MinWidth="200" BorderThickness="0 0 0 1"    
                                          ItemsSource="{Binding SelectedText.ShapeStdIndex}"
                                          SelectedItem="{Binding SelectedText.m_ShapeStdIndex, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                </StackPanel>
                                <!--矩形分割-->
                                <StackPanel Orientation="Vertical"  Visibility="{Binding SelectedText.m_name,Converter={StaticResource EnumToVisibilityConverter},ConverterParameter={x:Static m:eOperatorType.矩形分割}}" Grid.ColumnSpan="2">
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10">
                                        <TextBlock Text="使用索引:" VerticalAlignment="Center" Width="60"/>
                                        <ComboBox MinWidth="200" BorderThickness="0 0 0 1"    
                                          ItemsSource="{Binding SelectedText.DivisionIndex}"
                                          SelectedItem="{Binding SelectedText.m_DivisionWidth, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10" >
                                        <TextBlock Text="宽度:" VerticalAlignment="Center" Width="60"/>
                                        <mah:NumericUpDown Minimum="1" Value="{Binding SelectedText.m_DivisionWidth}" Width="200" Margin="5 0" BorderThickness="0 0 0 1"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="20,10,10,10" >
                                        <TextBlock Text="高度:" VerticalAlignment="Center" Width="60"/>
                                        <mah:NumericUpDown Minimum="1" Value="{Binding SelectedText.m_DivisionHeight}" Width="200" Margin="5 0" BorderThickness="0 0 0 1"/>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </GroupBox>
                    </Grid>
                </TabItem>
                <TabItem Header="数据结果" Height="30" VerticalAlignment="Bottom">
                    <Grid>
                        <Border Grid.Row="0">
                            <GroupBox Header="显示设置">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="5">
                                        <CheckBox Content="显示搜索区域" IsChecked="{Binding ShowSearchRegion}"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="5">
                                        <CheckBox Content="显示结果区域" IsChecked="{Binding ShowResultRegion}"/>
                                    </StackPanel>


                                </StackPanel>
                            </GroupBox>
                        </Border>
                    </Grid>
                </TabItem>
            </TabControl>
            <GridSplitter Grid.Column="1"/>
            <WinFormHost:WindowsFormsHost Margin="5" Grid.Column="2" x:Name="winFormHost">
            </WinFormHost:WindowsFormsHost>
            <Border Grid.Column="2" Grid.Row="1" BorderThickness="3">
                <DataGrid AutoGenerateColumns="False" x:Name="dg1"
                                      EnableColumnVirtualization="True"
                                      EnableRowVirtualization="True"
                                      VirtualizingPanel.IsVirtualizing="True"
                                      ItemsSource="{Binding RegionResultParams}" 
                                      SelectedIndex="{Binding CurrentRow}"
                                      FontSize="12" 
                                      RowHeaderWidth="20"
                                      SelectionUnit="FullRow"
                                      HeadersVisibility="Column"
                                      GridLinesVisibility="All"
                                      CanUserAddRows="False" 
                                      >
                    <DataGrid.Columns>
                        <DataGridTextColumn  Header="索引" IsReadOnly="True" Binding="{Binding ID}"/>
                        <DataGridTextColumn  Header="面积" IsReadOnly="False" Binding="{Binding Area}"/>
                        <DataGridTextColumn  Header="X" IsReadOnly="False" Binding="{Binding X}"/>
                        <DataGridTextColumn  Header="Y" IsReadOnly="False" Binding="{Binding Y}"/>
                        <DataGridTextColumn  Header="圆度" IsReadOnly="False" Binding="{Binding Roundness}"/>
                        <DataGridTextColumn  Header="矩形度" IsReadOnly="False" Binding="{Binding Rectangularity}"/>
                        <DataGridTextColumn  Header="宽度" IsReadOnly="False" Binding="{Binding Width}"/>
                        <DataGridTextColumn  Header="高度" IsReadOnly="False" Binding="{Binding Height}"/>
                        <DataGridTextColumn  Header="角度" IsReadOnly="False" Binding="{Binding Phi}"/>
                    </DataGrid.Columns>
                </DataGrid>
            </Border>
        </Grid>
        <Border Grid.Row="1" BorderBrush="White" BorderThickness="0 0.5 0 0">
            <DockPanel LastChildFill="True">
                <StackPanel Margin="10 0 0 0" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock><Run Text="耗时:"/><Run Text=" "/><Run Text="{Binding ModuleParam.ElapsedTime}"/><Run Text=" "/><Run Text="ms"/></TextBlock>
                    <TextBlock><Run Text="状态:"/><Run Text=" "/><Run Text="{Binding ModuleParam.Status, Converter={StaticResource StatusConverter}}"/></TextBlock>
                </StackPanel>
                <StackPanel Margin="150 0 0 0" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <!--<Button x:Name="btnComp" Content="对比原图" PreviewMouseLeftButtonDown="btnComp_PreviewMouseLeftButtonDown" PreviewMouseLeftButtonUp="btnComp_PreviewMouseLeftButtonUp"/>-->
                    <!--<Button x:Name="btnComp" Content="对比原图"   Command="{Binding ComposeCommand}"/>-->
                </StackPanel>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button x:Name="btnExecute" Content="执行" HorizontalAlignment="Right" Margin="10 0" Command="{Binding ExecuteCommand}"/>
                    <Button x:Name="btnCancel" Content="取消" HorizontalAlignment="Right" Margin="10 0" />
                    <Button x:Name="btnConfirm" Content="确认" HorizontalAlignment="Right" Margin="10 0" Command="{Binding ConfirmCommand}"
                            Background="#FFFF2000" BorderBrush="#FFFF2000"/>
                </StackPanel>
            </DockPanel>
        </Border>

    </Grid>
</vb:ModuleViewBase>
